<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FinTrack / Type</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* Base Typography */
    body { font-family: 'Inter', sans-serif; background-color: #FAFAFA; color: #171717; }
    h1, h2, h3, h4, .font-display { font-family: 'Space Grotesk', sans-serif; }
    
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-thumb { background: #e5e5e5; }
    
    /* Utilities */
    .tracking-tightest { letter-spacing: -0.04em; }
    .border-b-dashed { border-bottom-style: dashed; }
    
    /* Button Hover Effect */
    .btn-hover { transition: all 0.2s; }
    .btn-hover:hover { transform: translateY(-1px); box-shadow: 2px 2px 0px black; }
    .btn-active:active { transform: translateY(0px); box-shadow: 0px 0px 0px black; }
  </style>
</head>
<body class="pb-12 px-4 sm:px-8 pt-6 sm:pt-10 max-w-7xl mx-auto">

  <header class="flex flex-col md:flex-row justify-between items-start md:items-end gap-6 mb-12 border-b-2 border-black pb-6">
    <div>
      <h1 class="text-4xl sm:text-6xl font-bold tracking-tightest uppercase leading-none">FinTrack.</h1>
      <p class="text-neutral-500 font-medium mt-2">Personal Expense Dashboard</p>
    </div>
    
    <div class="flex gap-3">
      <button onclick="exportToCSV()" class="border border-neutral-300 hover:border-black hover:bg-black hover:text-white px-5 py-2 text-sm font-semibold transition-colors duration-200">
        Export CSV
      </button>
      <button onclick="clearAllData()" class="text-neutral-400 hover:text-red-600 px-3 py-2 text-sm font-semibold transition-colors">
        Reset
      </button>
    </div>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-12 gap-8 mb-16">
    
    <div class="md:col-span-5 flex flex-col justify-between">
      <div>
        <span class="text-sm font-semibold text-neutral-400 uppercase tracking-widest">Net Balance</span>
        <div class="relative mt-2">
          <h2 class="text-6xl sm:text-8xl font-bold tracking-tighter text-black leading-none">
            <span class="text-3xl align-top font-medium text-neutral-400">₱</span><span id="summaryBalance">0.00</span>
          </h2>
        </div>
      </div>
      
      <div class="mt-8">
        <div class="flex justify-between items-end mb-2">
           <label class="text-sm font-bold">Monthly Limit</label>
           <div class="flex items-baseline gap-2">
             <span class="text-xs text-neutral-400">EDIT</span>
             <input type="number" id="budgetLimitInput" onchange="updateBudgetLimit()" class="w-20 text-right font-mono text-sm bg-transparent border-b border-neutral-200 focus:border-black outline-none transition-colors" placeholder="0.00">
           </div>
        </div>
        <div class="w-full h-1 bg-neutral-100">
          <div id="budgetProgressBar" class="h-full bg-black transition-all duration-500" style="width: 0%"></div>
        </div>
        <div class="flex justify-between mt-2 font-mono text-xs text-neutral-400">
          <span>SPENT: <span id="textSpent" class="text-black">0.00</span></span>
          <span><span id="textPercent">0</span>%</span>
        </div>
      </div>
    </div>

    <div class="md:col-span-7 grid grid-cols-2 gap-px bg-neutral-200 border border-neutral-200">
      <div class="bg-white p-6 sm:p-8 flex flex-col justify-between h-40 sm:h-auto">
        <span class="text-xs font-bold text-neutral-400 uppercase tracking-widest">Total In</span>
        <p class="text-3xl sm:text-4xl font-display font-semibold text-green-600 tracking-tight">
          +<span id="summaryTotal">0.00</span>
        </p>
      </div>
      <div class="bg-white p-6 sm:p-8 flex flex-col justify-between h-40 sm:h-auto">
        <span class="text-xs font-bold text-neutral-400 uppercase tracking-widest">Total Out</span>
        <p class="text-3xl sm:text-4xl font-display font-semibold text-red-600 tracking-tight">
          -<span id="summaryExpenses">0.00</span>
        </p>
      </div>
      <div class="col-span-2 bg-white p-6 sm:p-8 relative">
        <span class="text-xs font-bold text-neutral-400 uppercase tracking-widest mb-4 block">Distribution</span>
        <div class="h-40 w-full flex items-center justify-center">
          <canvas id="expenseChart"></canvas>
          <div id="chartEmptyState" class="absolute inset-0 flex items-center justify-center text-neutral-300 font-display text-2xl font-bold uppercase pointer-events-none">
            No Data
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-24">

    <div>
      <h3 class="text-2xl font-bold mb-6 flex items-center gap-2">
        <span class="w-2 h-2 bg-green-500 rounded-full"></span> Income
      </h3>
      
      <div class="flex gap-0 mb-8 border border-neutral-200 focus-within:border-black focus-within:ring-1 focus-within:ring-black transition-all">
        <input id="walletName" class="flex-1 p-3 bg-white outline-none font-medium placeholder-neutral-300" type="text" placeholder="Source">
        <div class="w-px bg-neutral-200"></div>
        <input id="walletAmount" class="w-24 p-3 bg-white outline-none font-mono text-right placeholder-neutral-300" type="number" placeholder="0.00">
        <button onclick="addWallet()" class="bg-black text-white px-5 font-bold text-sm tracking-wide uppercase hover:bg-neutral-800 transition-colors">
          Add
        </button>
      </div>

      <div id="walletList" class="space-y-0 border-t border-black">
        </div>
    </div>

    <div>
      <h3 class="text-2xl font-bold mb-6 flex items-center gap-2">
        <span class="w-2 h-2 bg-red-500 rounded-full"></span> Expenses
      </h3>
      
      <div class="mb-8 border border-neutral-200 focus-within:border-black focus-within:ring-1 focus-within:ring-black transition-all bg-white">
        <div class="flex border-b border-neutral-100">
          <input id="expenseName" class="flex-1 p-3 bg-white outline-none font-medium placeholder-neutral-300" type="text" placeholder="Description">
          <div class="w-px bg-neutral-100"></div>
          <select id="expenseCategory" class="p-3 bg-white outline-none font-medium text-sm text-neutral-500 cursor-pointer hover:text-black transition-colors">
            <option value="Food">Food</option>
            <option value="Transport">Transport</option>
            <option value="Utilities">Utilities</option>
            <option value="Entertainment">Fun</option>
            <option value="Shopping">Shop</option>
            <option value="Health">Health</option>
            <option value="Others">Other</option>
          </select>
        </div>
        <div class="flex">
          <input id="expenseAmount" class="flex-1 p-3 bg-white outline-none font-mono placeholder-neutral-300" type="number" placeholder="0.00">
          <button onclick="addExpense()" class="bg-black text-white px-6 font-bold text-sm tracking-wide uppercase hover:bg-neutral-800 transition-colors">
            Add Entry
          </button>
        </div>
      </div>

      <div id="expenseList" class="space-y-0 border-t border-black">
        </div>
    </div>

  </div>

  <script>
    // --- COLOR PALETTE (Swiss Style: Bold & High Contrast) ---
    // Instead of icons, we use color tags
    const categoryConfig = {
      'Food': '#000000',          // Black
      'Transport': '#525252',     // Dark Gray
      'Utilities': '#2563eb',     // Blue
      'Entertainment': '#9333ea', // Purple
      'Shopping': '#db2777',      // Pink
      'Health': '#059669',        // Green
      'Others': '#d4d4d4'         // Light Gray
    };

    let wallets = [];
    let expenses = [];
    let budgetLimit = 0;
    let myChart = null;

    window.onload = function() { loadData(); };

    function saveData() {
      localStorage.setItem('wallets', JSON.stringify(wallets));
      localStorage.setItem('expenses', JSON.stringify(expenses));
      localStorage.setItem('budgetLimit', budgetLimit.toString());
    }

    function loadData() {
      const storedWallets = localStorage.getItem('wallets');
      const storedExpenses = localStorage.getItem('expenses');
      const storedLimit = localStorage.getItem('budgetLimit');

      if (storedWallets) wallets = JSON.parse(storedWallets);
      if (storedExpenses) expenses = JSON.parse(storedExpenses);
      if (storedLimit) {
        budgetLimit = parseFloat(storedLimit);
        document.getElementById('budgetLimitInput').value = budgetLimit;
      }
      updateWalletDisplay();
      updateExpenseDisplay();
    }

    function clearAllData() {
      if(confirm('Clear dashboard?')) {
        wallets = []; expenses = []; budgetLimit = 0;
        document.getElementById('budgetLimitInput').value = '';
        saveData(); updateWalletDisplay(); updateExpenseDisplay();
      }
    }

    const formatCurrency = (num) => num.toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    const getFormattedDate = () => {
      const now = new Date();
      return now.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
    };

    function exportToCSV() {
      if (expenses.length === 0 && wallets.length === 0) { alert("No data."); return; }
      let csv = "data:text/csv;charset=utf-8,Type,Name,Category,Amount,Date\n";
      wallets.forEach(row => csv += `Income,${row.name},Source,${row.amount},${row.date||'N/A'}\n`);
      expenses.forEach(row => csv += `Expense,${row.name},${row.category},${row.amount},${row.date||'N/A'}\n`);
      const link = document.createElement("a");
      link.setAttribute("href", encodeURI(csv));
      link.setAttribute("download", "fintrack_export.csv");
      document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }

    function updateBudgetLimit() {
      const input = document.getElementById('budgetLimitInput');
      budgetLimit = parseFloat(input.value) || 0;
      saveData(); updateProgressBar();
    }

    function updateProgressBar() {
      const totalExpenses = expenses.reduce((acc, e) => acc + e.amount, 0);
      const bar = document.getElementById('budgetProgressBar');
      document.getElementById('textSpent').textContent = formatCurrency(totalExpenses);
      document.getElementById('textPercent').textContent = budgetLimit > 0 ? ((totalExpenses/budgetLimit)*100).toFixed(0) : "0";

      if (budgetLimit === 0) { bar.style.width = '0%'; return; }
      
      const percentage = Math.min((totalExpenses / budgetLimit) * 100, 100);
      bar.style.width = percentage + '%';
      
      // Minimalist color logic: Black (Normal) -> Red (Over)
      if (totalExpenses > budgetLimit) bar.style.backgroundColor = '#dc2626'; // Red
      else bar.style.backgroundColor = '#000000'; // Black
    }

    function updateChart() {
      const ctx = document.getElementById('expenseChart').getContext('2d');
      const emptyState = document.getElementById('chartEmptyState');
      
      if (expenses.length === 0) {
        if (myChart) myChart.destroy();
        emptyState.classList.remove('hidden'); return;
      } else { emptyState.classList.add('hidden'); }

      const categoryTotals = {};
      expenses.forEach(exp => {
        if (!categoryTotals[exp.category]) categoryTotals[exp.category] = 0;
        categoryTotals[exp.category] += exp.amount;
      });

      if (myChart) myChart.destroy();
      
      // Swiss Chart Style: No borders, distinct colors
      myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: Object.keys(categoryTotals),
          datasets: [{
            data: Object.values(categoryTotals),
            backgroundColor: Object.keys(categoryTotals).map(cat => categoryConfig[cat] || '#d4d4d4'),
            borderWidth: 0,
            hoverOffset: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          cutout: '65%'
        }
      });
    }

    function updateWalletDisplay() {
      const list = document.getElementById('walletList');
      let total = 0;
      list.innerHTML = '';
      if (wallets.length === 0) list.innerHTML = '<div class="py-6 text-neutral-400 text-sm font-mono uppercase">Empty</div>';
      else {
        wallets.slice().reverse().forEach((wallet, index) => {
          total += wallet.amount;
          list.innerHTML += `
            <div class="group flex justify-between items-baseline py-4 border-b border-neutral-100 hover:bg-neutral-50 transition-colors px-2 -mx-2">
              <div>
                <h4 class="font-bold text-lg leading-none">${wallet.name}</h4>
                <p class="text-xs font-mono text-neutral-400 mt-1 uppercase tracking-wide">${wallet.date || '—'}</p>
              </div>
              <div class="flex items-center gap-4">
                <span class="font-mono font-medium text-green-600">+${formatCurrency(wallet.amount)}</span>
                <button onclick="deleteWallet(${wallets.length - 1 - index})" class="text-xs font-bold uppercase text-neutral-300 hover:text-black opacity-0 group-hover:opacity-100 transition-opacity">
                  Remove
                </button>
              </div>
            </div>`;
        });
      }
      document.getElementById('summaryTotal').textContent = formatCurrency(total);
      updateBalance();
    }

    function updateExpenseDisplay() {
      const list = document.getElementById('expenseList');
      let total = 0;
      list.innerHTML = '';
      if (expenses.length === 0) list.innerHTML = '<div class="py-6 text-neutral-400 text-sm font-mono uppercase">Empty</div>';
      else {
        expenses.slice().reverse().forEach((exp, index) => {
          total += exp.amount;
          // Use a colored square instead of an icon
          const color = categoryConfig[exp.category] || '#d4d4d4';
          
          list.innerHTML += `
            <div class="group flex justify-between items-center py-4 border-b border-neutral-100 hover:bg-neutral-50 transition-colors px-2 -mx-2">
              <div class="flex items-baseline gap-3">
                <div class="w-2 h-2 rounded-full mt-1.5 shrink-0" style="background-color: ${color}"></div>
                <div>
                  <h4 class="font-semibold text-base leading-none">${exp.name}</h4>
                  <div class="flex gap-2 mt-1">
                    <span class="text-[10px] font-bold uppercase tracking-wider text-neutral-400">${exp.category}</span>
                    <span class="text-[10px] font-mono text-neutral-300">${exp.date || ''}</span>
                  </div>
                </div>
              </div>
              <div class="flex items-center gap-4">
                <span class="font-mono font-medium text-black">${formatCurrency(exp.amount)}</span>
                <button onclick="deleteExpense(${expenses.length - 1 - index})" class="text-xs font-bold uppercase text-neutral-300 hover:text-black opacity-0 group-hover:opacity-100 transition-opacity">
                  Remove
                </button>
              </div>
            </div>`;
        });
      }
      document.getElementById('summaryExpenses').textContent = formatCurrency(total);
      updateBalance(); updateChart(); updateProgressBar();
    }

    function addWallet() {
      const name = document.getElementById('walletName').value.trim();
      const amount = parseFloat(document.getElementById('walletAmount').value);
      if (name && !isNaN(amount) && amount > 0) {
        wallets.push({ name, amount, date: getFormattedDate() });
        document.getElementById('walletName').value = ''; document.getElementById('walletAmount').value = '';
        saveData(); updateWalletDisplay();
      }
    }
    function deleteWallet(i) { wallets.splice(i, 1); saveData(); updateWalletDisplay(); }

    function addExpense() {
      const name = document.getElementById('expenseName').value.trim();
      const cat = document.getElementById('expenseCategory').value;
      const amount = parseFloat(document.getElementById('expenseAmount').value);
      if (name && !isNaN(amount) && amount > 0) {
        expenses.push({ name, category: cat, amount, date: getFormattedDate() });
        document.getElementById('expenseName').value = ''; document.getElementById('expenseAmount').value = '';
        saveData(); updateExpenseDisplay();
      }
    }
    function deleteExpense(i) { expenses.splice(i, 1); saveData(); updateExpenseDisplay(); }

    function updateBalance() {
      const total = wallets.reduce((acc, w) => acc + w.amount, 0);
      const exp = expenses.reduce((acc, e) => acc + e.amount, 0);
      const rem = total - exp;
      document.getElementById('summaryBalance').textContent = formatCurrency(rem);
    }
  </script>
</body>
</html>